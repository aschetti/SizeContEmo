---
title: "<center> <h1>***SIZECONTEMO***</h1> </center>"
author: '[Antonio Schettino](https://www.researchgate.net/profile/Antonio_Schettino2 "Antonio Schettino")'
date: '`r Sys.Date()`'
output:
  html_document:
    theme: united
    highlight: tango
    code_folding: hide
    toc: true
    toc_float: true
---

In this project we will investigate the electrophysiological correlates of the combined processing of basic visual properties (i.e., size and contrast) and the emotional content of simple words. 

```{r setup_environment,echo=FALSE,warning=FALSE,message=FALSE}
# setup work environment
# dev.off() # clear plots (if no plots are present, comment it out or it will throw an error)
cat("\014") # clear console
rm(list=ls()) # clear environment
set.seed(9001) # specify seed for RNG and ensure reproducible results (it's over 9000!)

expname <- "SizeContEmo" # experiment name
expphase <- "pilot" # experiment phase
wd <- paste("D:/OneDrive - UGent/",expname,"/analysis/EEG/",expphase,"/",sep="") # work directory
setwd(wd) # set work directory

# load relevant libraries
library(knitr) # dynamic report generation
library(Rmisc) # for advanced summary functions
library(yarrr) # amazing graphs
library(fitdistrplus) # fit parametric distributions to non-censored or censored data
library(lme4) # linear mixed-effects models
library(car) # functions for applied regressions
library(lsmeans) # obtain least-squares means for linear, generalized linear, and mixed models
```

```{r setup_output}
# setup report output
options(width=120,scipen=999,digits=3) # change output width (for better printing), disable scientific notation (default: scipen=0), constrain output to 4 decimals
opts_chunk$set(warning=FALSE,message=FALSE,fig.width=10,fig.height=6) # for each chunk, display the output but not the R code (echo=FALSE), no package warnings (message=FALSE), no package messages (message=FALSE), width and height of all figures
```

```{r main_data}
data.EEG.trial <- read.csv(paste0(expphase,"_trialEEG.csv"),header=TRUE) # load data

data.EEG.trial <- data.EEG.trial[data.EEG.trial$bin %in% c(1:8),] # subset trials main experiment

data.EEG.trial$size <- revalue(factor(data.EEG.trial$bin),c("1"="large","2"="small","3"="large","4"="small","5"="large","6"="small","7"="large","8"="small")) # main effect of size

data.EEG.trial$cont <- revalue(factor(data.EEG.trial$bin),c("1"="dark","2"="dark","3"="bright","4"="bright","5"="dark","6"="dark","7"="bright","8"="bright")) # main effect of contrast

data.EEG.trial$emo <- revalue(factor(data.EEG.trial$bin),c("1"="negative","2"="negative","3"="negative","4"="negative","5"="neutral","6"="neutral","7"="neutral","8"="neutral")) # main effect of emotion

data.EEG.trial$bin <- revalue(factor(data.EEG.trial$bin),c("1"="negativeLargeDark","2"="negativeSmallDark","3"="negativeLargeBright","4"="negativeSmallBright","5"="neutralLargeDark","6"="neutralSmallDark","7"="neutralLargeBright","8"="neutralSmallBright")) # recode bin variable

# add words for each trial 
data.EEG.trialWords <- read.csv(paste0(expphase,"_words.csv"),header=TRUE) # load data
data.EEG.trial$word <- data.EEG.trialWords[1:1434,"word"] # ends at 1434 because of a bug in extracting the trials in pilot12. hopefully we won't have this problem in the main experimental sample
rm(data.EEG.trialWords) # delete word data 

data.EEG.trial <- within(data.EEG.trial,size<-relevel(size,ref="large")) # reference: large size
data.EEG.trial <- within(data.EEG.trial,cont<-relevel(cont,ref="dark")) # reference: high contrast
data.EEG.trial <- within(data.EEG.trial,emo<-relevel(emo,ref="neutral")) # reference: neutral emotion
```

The data we will use in this demo come from a pilot experiment (N=`r length(unique(data.EEG.trial$participant))`).   
   
```{r main_normality}
# assess normality
ERPcomp <- factor(c("P1","N1","EPN","LPP")) # ERP components

for(i in levels(ERPcomp)) { # loop through components
  for(j in levels(data.EEG.trial$bin)) { # loop through conditions
    tempdata <- data.EEG.trial[data.EEG.trial$bin==j,i] # subset current condition and ERP
    
    jpeg(filename=paste(wd,"graphs/main/",i,"/",j,".jpg",sep=""),width=480,height=480,units="px",quality=100) # save as jpeg
    plotdist(tempdata,histo=TRUE,demp=TRUE) # empirical density and cumulative distribution
    dev.off()
  }
}
```

Density plots (not shown in the output) suggest that the normal distribution is a parsimonious approximate description of the data.   
   
We will use linear mixed-effects models with random intercepts and fixed slopes. Models with random slopes have troubles converging, particularly on small datasets.   
The random factor is participants and the individual word per trial.
   
We will compute the following models:   
   
1. null model
2. main effects of size and emotion
3. interactive effects of size and emotion
4. main effects of contrast and emotion
5. interactive effects of contrast and emotion
6. main effects of size, contrast, and emotion
7. interactive effects of size, contrast, and emotion   
   
We will then compare them all using the Bayesian Infomation Criterion (BIC).

<center> <h1>*P1*</h1> </center>

```{r main_P1_graph}
# summarize data
summary.data.EEG.trial <- summarySEwithin(data.EEG.trial,"P1",withinvars=c("size","cont","emo"),idvar="participant")
kable(summary.data.EEG.trial)

# P1 graph
pirateplot(formula=P1~emo+cont+size, # dependent~independent variables
           data=data.EEG.trial, # data frame
           main="", # main title
           xlim=NULL, # x-axis: limits
           xlab="",  # x-axis: label
           ylim=c(-20,20), # y-axis: limits
           ylab=expression(paste("amplitude (",mu,"V)")), # y-axis: label
           inf.method="ci", # type of inference: 95% confidence intervals
           pal="xmen") # color palette [see piratepal(palette="all")]
```  

```{r main_P1_models}
### null model
P1.null.lmer <- lmer(P1~1+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.P1.null.lmer <- summary(P1.null.lmer) # summary model

### main effects of size and emotion
P1.sizeplusemo.lmer <- lmer(P1~size+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.P1.sizeplusemo.lmer <- summary(P1.sizeplusemo.lmer) # summary model
pvalue.P1.sizeplusemo.lmer <- Anova(P1.sizeplusemo.lmer) # calculate p-values
# contrasts
P1.sizeplusemo.lmer.contr <- lsmeans(P1.sizeplusemo.lmer,pairwise~size+emo,adjust="tukey")
# P1.sizeplusemo.lmer.contr$contrasts

### interactive effects of size and emotion
P1.sizebyemo.lmer <- lmer(P1~size:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.P1.sizebyemo.lmer <- summary(P1.sizebyemo.lmer) # summary model
pvalue.P1.sizebyemo.lmer <- Anova(P1.sizebyemo.lmer) # calculate p-values
# contrasts
P1.sizebyemo.lmer.contr <- lsmeans(P1.sizebyemo.lmer,pairwise~size:emo,adjust="tukey")
# P1.sizebyemo.lmer.contr$contrasts

### main effects of contrast and emotion
P1.contplusemo.lmer <- lmer(P1~cont+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.P1.contplusemo.lmer <- summary(P1.contplusemo.lmer) # summary model
pvalue.P1.contplusemo.lmer <- Anova(P1.contplusemo.lmer) # calculate p-values
# contrasts
P1.contplusemo.lmer.contr <- lsmeans(P1.contplusemo.lmer,pairwise~cont+emo,adjust="tukey")
# P1.contplusemo.lmer.contr$contrasts

### interactive effects of contrast and emotion
P1.contbyemo.lmer <- lmer(P1~cont:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.P1.contbyemo.lmer <- summary(P1.contbyemo.lmer) # summary model
pvalue.P1.contbyemo.lmer <- Anova(P1.contbyemo.lmer) # calculate p-values
# contrasts
P1.contbyemo.lmer.contr <- lsmeans(P1.contbyemo.lmer,pairwise~cont:emo,adjust="tukey")
# P1.contbyemo.lmer.contr$contrasts

### main effects of size, contrast, and emotion
P1.sizepluscontplusemo.lmer <- lmer(P1~size+cont+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.P1.sizepluscontplusemo.lmer <- summary(P1.sizepluscontplusemo.lmer) # summary model
pvalue.P1.sizepluscontplusemo.lmer <- Anova(P1.sizepluscontplusemo.lmer) # calculate p-values
# contrasts
P1.sizepluscontplusemo.lmer.contr <- lsmeans(P1.sizepluscontplusemo.lmer,pairwise~size+cont+emo,adjust="tukey")
# P1.sizepluscontplusemo.lmer.contr$contrasts

### interactive effects of size, contrast, and emotion
P1.sizebycontbyemo.lmer <- lmer(P1~size:cont:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.P1.sizebycontbyemo.lmer <- summary(P1.sizebycontbyemo.lmer) # summary model
pvalue.P1.sizebycontbyemo.lmer <- Anova(P1.sizebycontbyemo.lmer) # calculate p-values
# contrasts
P1.sizebycontbyemo.lmer.contr <- lsmeans(P1.sizebycontbyemo.lmer,pairwise~size:cont:emo,adjust="tukey")
# P1.sizebycontbyemo.lmer.contr$contrasts

### model comparison via Bayesian Infomation Criterion (BIC)
P1.lmer.BIC <- BIC(P1.null.lmer,P1.sizeplusemo.lmer,P1.sizebyemo.lmer,P1.contplusemo.lmer,P1.contbyemo.lmer,P1.sizepluscontplusemo.lmer,P1.sizebycontbyemo.lmer)

# summary
compare.P1.lmer <- data.frame("model"=c("null","size + emo","size x emo","contr + emo","cont x emo","size + cont + emo","size x cont x emo"),"BIC"=P1.lmer.BIC$BIC)
compare.P1.lmer <- compare.P1.lmer[with(compare.P1.lmer,order(BIC)),] # sort according to BIC (in ascending order)
kable(compare.P1.lmer)
```
   
The model to prefer should be `r compare.P1.lmer[1,1]`. 

<center> <h1>*N1*</h1> </center>

```{r main_N1_graph}
# summarize data
summary.data.EEG.trial <- summarySEwithin(data.EEG.trial,"N1",withinvars=c("size","cont","emo"),idvar="participant")
summary.data.EEG.trial

# N1 graph
pirateplot(formula=N1~emo+cont+size, # dependent~independent variables
           data=data.EEG.trial, # data frame
           main="", # main title
           xlim=NULL, # x-axis: limits
           xlab="",  # x-axis: label
           ylim=c(-20,20), # y-axis: limits
           ylab=expression(paste("amplitude (",mu,"V)")), # y-axis: label
           inf.method="ci", # type of inference: 95% confidence intervals
           pal="xmen") # color palette [see piratepal(palette="all")]
```  

```{r main_N1_models}
### null model
N1.null.lmer <- lmer(N1~1+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.N1.null.lmer <- summary(N1.null.lmer) # summary model

### main effects of size and emotion
N1.sizeplusemo.lmer <- lmer(N1~size+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.N1.sizeplusemo.lmer <- summary(N1.sizeplusemo.lmer) # summary model
pvalue.N1.sizeplusemo.lmer <- Anova(N1.sizeplusemo.lmer) # calculate p-values
# contrasts
N1.sizeplusemo.lmer.contr <- lsmeans(N1.sizeplusemo.lmer,pairwise~size+emo,adjust="tukey")
# N1.sizeplusemo.lmer.contr$contrasts

### interactive effects of size and emotion
N1.sizebyemo.lmer <- lmer(N1~size:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.N1.sizebyemo.lmer <- summary(N1.sizebyemo.lmer) # summary model
pvalue.N1.sizebyemo.lmer <- Anova(N1.sizebyemo.lmer) # calculate p-values
# contrasts
N1.sizebyemo.lmer.contr <- lsmeans(N1.sizebyemo.lmer,pairwise~size:emo,adjust="tukey")
# N1.sizebyemo.lmer.contr$contrasts

### main effects of contrast and emotion
N1.contplusemo.lmer <- lmer(N1~cont+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.N1.contplusemo.lmer <- summary(N1.contplusemo.lmer) # summary model
pvalue.N1.contplusemo.lmer <- Anova(N1.contplusemo.lmer) # calculate p-values
# contrasts
N1.contplusemo.lmer.contr <- lsmeans(N1.contplusemo.lmer,pairwise~cont+emo,adjust="tukey")
# N1.contplusemo.lmer.contr$contrasts

### interactive effects of contrast and emotion
N1.contbyemo.lmer <- lmer(N1~cont:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.N1.contbyemo.lmer <- summary(N1.contbyemo.lmer) # summary model
pvalue.N1.contbyemo.lmer <- Anova(N1.contbyemo.lmer) # calculate p-values
# contrasts
N1.contbyemo.lmer.contr <- lsmeans(N1.contbyemo.lmer,pairwise~cont:emo,adjust="tukey")
# N1.contbyemo.lmer.contr$contrasts

### main effects of size, contrast, and emotion
N1.sizepluscontplusemo.lmer <- lmer(N1~size+cont+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.N1.sizepluscontplusemo.lmer <- summary(N1.sizepluscontplusemo.lmer) # summary model
pvalue.N1.sizepluscontplusemo.lmer <- Anova(N1.sizepluscontplusemo.lmer) # calculate p-values
# contrasts
N1.sizepluscontplusemo.lmer.contr <- lsmeans(N1.sizepluscontplusemo.lmer,pairwise~size+cont+emo,adjust="tukey")
# N1.sizepluscontplusemo.lmer.contr$contrasts

### interactive effects of size, contrast, and emotion
N1.sizebycontbyemo.lmer <- lmer(N1~size:cont:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.N1.sizebycontbyemo.lmer <- summary(N1.sizebycontbyemo.lmer) # summary model
pvalue.N1.sizebycontbyemo.lmer <- Anova(N1.sizebycontbyemo.lmer) # calculate p-values
# contrasts
N1.sizebycontbyemo.lmer.contr <- lsmeans(N1.sizebycontbyemo.lmer,pairwise~size:cont:emo,adjust="tukey")
# N1.sizebycontbyemo.lmer.contr$contrasts

### model comparison via Bayesian Infomation Criterion (BIC)
N1.lmer.BIC <- BIC(N1.null.lmer,N1.sizeplusemo.lmer,N1.sizebyemo.lmer,N1.contplusemo.lmer,N1.contbyemo.lmer,N1.sizepluscontplusemo.lmer,N1.sizebycontbyemo.lmer)

# summary
compare.N1.lmer <- data.frame("model"=c("null","size + emo","size x emo","contr + emo","cont x emo","size + cont + emo","size x cont x emo"),"BIC"=N1.lmer.BIC$BIC)
compare.N1.lmer <- compare.N1.lmer[with(compare.N1.lmer,order(BIC)),] # sort according to BIC (in ascending order)
kable(compare.N1.lmer)
```
   
The model to prefer should be `r compare.N1.lmer[1,1]`. 

<center> <h1>*EPN*</h1> </center>

```{r main_EPN_graph}
# summarize data
summary.data.EEG.trial <- summarySEwithin(data.EEG.trial,"EPN",withinvars=c("size","cont","emo"),idvar="participant")
summary.data.EEG.trial

# EPN graph
pirateplot(formula=EPN~emo+cont+size, # dependent~independent variables
           data=data.EEG.trial, # data frame
           main="", # main title
           xlim=NULL, # x-axis: limits
           xlab="",  # x-axis: label
           ylim=c(-20,20), # y-axis: limits
           ylab=expression(paste("amplitude (",mu,"V)")), # y-axis: label
           inf.method="ci", # type of inference: 95% confidence intervals
           pal="xmen") # color palette [see piratepal(palette="all")]
```  

```{r main_EPN_models}
### null model
EPN.null.lmer <- lmer(EPN~1+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.EPN.null.lmer <- summary(EPN.null.lmer) # summary model

### main effects of size and emotion
EPN.sizeplusemo.lmer <- lmer(EPN~size+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.EPN.sizeplusemo.lmer <- summary(EPN.sizeplusemo.lmer) # summary model
pvalue.EPN.sizeplusemo.lmer <- Anova(EPN.sizeplusemo.lmer) # calculate p-values
# contrasts
EPN.sizeplusemo.lmer.contr <- lsmeans(EPN.sizeplusemo.lmer,pairwise~size+emo,adjust="tukey")
# EPN.sizeplusemo.lmer.contr$contrasts

### interactive effects of size and emotion
EPN.sizebyemo.lmer <- lmer(EPN~size:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.EPN.sizebyemo.lmer <- summary(EPN.sizebyemo.lmer) # summary model
pvalue.EPN.sizebyemo.lmer <- Anova(EPN.sizebyemo.lmer) # calculate p-values
# contrasts
EPN.sizebyemo.lmer.contr <- lsmeans(EPN.sizebyemo.lmer,pairwise~size:emo,adjust="tukey")
# EPN.sizebyemo.lmer.contr$contrasts

### main effects of contrast and emotion
EPN.contplusemo.lmer <- lmer(EPN~cont+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.EPN.contplusemo.lmer <- summary(EPN.contplusemo.lmer) # summary model
pvalue.EPN.contplusemo.lmer <- Anova(EPN.contplusemo.lmer) # calculate p-values
# contrasts
EPN.contplusemo.lmer.contr <- lsmeans(EPN.contplusemo.lmer,pairwise~cont+emo,adjust="tukey")
# EPN.contplusemo.lmer.contr$contrasts

### interactive effects of contrast and emotion
EPN.contbyemo.lmer <- lmer(EPN~cont:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.EPN.contbyemo.lmer <- summary(EPN.contbyemo.lmer) # summary model
pvalue.EPN.contbyemo.lmer <- Anova(EPN.contbyemo.lmer) # calculate p-values
# contrasts
EPN.contbyemo.lmer.contr <- lsmeans(EPN.contbyemo.lmer,pairwise~cont:emo,adjust="tukey")
# EPN.contbyemo.lmer.contr$contrasts

### main effects of size, contrast, and emotion
EPN.sizepluscontplusemo.lmer <- lmer(EPN~size+cont+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.EPN.sizepluscontplusemo.lmer <- summary(EPN.sizepluscontplusemo.lmer) # summary model
pvalue.EPN.sizepluscontplusemo.lmer <- Anova(EPN.sizepluscontplusemo.lmer) # calculate p-values
# contrasts
EPN.sizepluscontplusemo.lmer.contr <- lsmeans(EPN.sizepluscontplusemo.lmer,pairwise~size+cont+emo,adjust="tukey")
# EPN.sizepluscontplusemo.lmer.contr$contrasts

### interactive effects of size, contrast, and emotion
EPN.sizebycontbyemo.lmer <- lmer(EPN~size:cont:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.EPN.sizebycontbyemo.lmer <- summary(EPN.sizebycontbyemo.lmer) # summary model
pvalue.EPN.sizebycontbyemo.lmer <- Anova(EPN.sizebycontbyemo.lmer) # calculate p-values
# contrasts
EPN.sizebycontbyemo.lmer.contr <- lsmeans(EPN.sizebycontbyemo.lmer,pairwise~size:cont:emo,adjust="tukey")
# EPN.sizebycontbyemo.lmer.contr$contrasts

### model comparison via Bayesian Infomation Criterion (BIC)
EPN.lmer.BIC <- BIC(EPN.null.lmer,EPN.sizeplusemo.lmer,EPN.sizebyemo.lmer,EPN.contplusemo.lmer,EPN.contbyemo.lmer,EPN.sizepluscontplusemo.lmer,EPN.sizebycontbyemo.lmer)

# summary
compare.EPN.lmer <- data.frame("model"=c("null","size + emo","size x emo","contr + emo","cont x emo","size + cont + emo","size x cont x emo"),"BIC"=EPN.lmer.BIC$BIC)
compare.EPN.lmer <- compare.EPN.lmer[with(compare.EPN.lmer,order(BIC)),] # sort according to BIC (in ascending order)
kable(compare.EPN.lmer)
```
   
The model to prefer should be `r compare.EPN.lmer[1,1]`.

<center> <h1>*LPP*</h1> </center>

```{r main_LPP_graph}
# summarize data
summary.data.EEG.trial <- summarySEwithin(data.EEG.trial,"LPP",withinvars=c("size","cont","emo"),idvar="participant")
summary.data.EEG.trial

# LPP graph
pirateplot(formula=LPP~emo+cont+size, # dependent~independent variables
           data=data.EEG.trial, # data frame
           main="", # main title
           xlim=NULL, # x-axis: limits
           xlab="",  # x-axis: label
           ylim=c(-20,20), # y-axis: limits
           ylab=expression(paste("amplitude (",mu,"V)")), # y-axis: label
           inf.method="ci", # type of inference: 95% confidence intervals
           pal="xmen") # color palette [see piratepal(palette="all")]
```  

```{r main_LPP_models}
### null model
LPP.null.lmer <- lmer(LPP~1+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.LPP.null.lmer <- summary(LPP.null.lmer) # summary model

### main effects of size and emotion
LPP.sizeplusemo.lmer <- lmer(LPP~size+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.LPP.sizeplusemo.lmer <- summary(LPP.sizeplusemo.lmer) # summary model
pvalue.LPP.sizeplusemo.lmer <- Anova(LPP.sizeplusemo.lmer) # calculate p-values
# contrasts
LPP.sizeplusemo.lmer.contr <- lsmeans(LPP.sizeplusemo.lmer,pairwise~size+emo,adjust="tukey")
# LPP.sizeplusemo.lmer.contr$contrasts

### interactive effects of size and emotion
LPP.sizebyemo.lmer <- lmer(LPP~size:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.LPP.sizebyemo.lmer <- summary(LPP.sizebyemo.lmer) # summary model
pvalue.LPP.sizebyemo.lmer <- Anova(LPP.sizebyemo.lmer) # calculate p-values
# contrasts
LPP.sizebyemo.lmer.contr <- lsmeans(LPP.sizebyemo.lmer,pairwise~size:emo,adjust="tukey")
# LPP.sizebyemo.lmer.contr$contrasts

### main effects of contrast and emotion
LPP.contplusemo.lmer <- lmer(LPP~cont+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.LPP.contplusemo.lmer <- summary(LPP.contplusemo.lmer) # summary model
pvalue.LPP.contplusemo.lmer <- Anova(LPP.contplusemo.lmer) # calculate p-values
# contrasts
LPP.contplusemo.lmer.contr <- lsmeans(LPP.contplusemo.lmer,pairwise~cont+emo,adjust="tukey")
# LPP.contplusemo.lmer.contr$contrasts

### interactive effects of contrast and emotion
LPP.contbyemo.lmer <- lmer(LPP~cont:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.LPP.contbyemo.lmer <- summary(LPP.contbyemo.lmer) # summary model
pvalue.LPP.contbyemo.lmer <- Anova(LPP.contbyemo.lmer) # calculate p-values
# contrasts
LPP.contbyemo.lmer.contr <- lsmeans(LPP.contbyemo.lmer,pairwise~cont:emo,adjust="tukey")
# LPP.contbyemo.lmer.contr$contrasts

### main effects of size, contrast, and emotion
LPP.sizepluscontplusemo.lmer <- lmer(LPP~size+cont+emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.LPP.sizepluscontplusemo.lmer <- summary(LPP.sizepluscontplusemo.lmer) # summary model
pvalue.LPP.sizepluscontplusemo.lmer <- Anova(LPP.sizepluscontplusemo.lmer) # calculate p-values
# contrasts
LPP.sizepluscontplusemo.lmer.contr <- lsmeans(LPP.sizepluscontplusemo.lmer,pairwise~size+cont+emo,adjust="tukey")
# LPP.sizepluscontplusemo.lmer.contr$contrasts

### interactive effects of size, contrast, and emotion
LPP.sizebycontbyemo.lmer <- lmer(LPP~size:cont:emo+(1|participant)+(1|word),data=data.EEG.trial) # model
summary.LPP.sizebycontbyemo.lmer <- summary(LPP.sizebycontbyemo.lmer) # summary model
pvalue.LPP.sizebycontbyemo.lmer <- Anova(LPP.sizebycontbyemo.lmer) # calculate p-values
# contrasts
LPP.sizebycontbyemo.lmer.contr <- lsmeans(LPP.sizebycontbyemo.lmer,pairwise~size:cont:emo,adjust="tukey")
# LPP.sizebycontbyemo.lmer.contr$contrasts

### model comparison via Bayesian Infomation Criterion (BIC)
LPP.lmer.BIC <- BIC(LPP.null.lmer,LPP.sizeplusemo.lmer,LPP.sizebyemo.lmer,LPP.contplusemo.lmer,LPP.contbyemo.lmer,LPP.sizepluscontplusemo.lmer,LPP.sizebycontbyemo.lmer)

# summary
compare.LPP.lmer <- data.frame("model"=c("null","size + emo","size x emo","contr + emo","cont x emo","size + cont + emo","size x cont x emo"),"BIC"=LPP.lmer.BIC$BIC)
compare.LPP.lmer <- compare.LPP.lmer[with(compare.LPP.lmer,order(BIC)),] # sort according to BIC (in ascending order)
kable(compare.LPP.lmer)
```
   
The model to prefer should be `r compare.LPP.lmer[1,1]`. 


